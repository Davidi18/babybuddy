{% extends 'babybuddy/base.html' %}
{% load babybuddy i18n static timers %}
{% block nav %}
    <nav class="navbar navbar-expand-md navbar bg-dark sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand me-2 d-flex align-items-center" href={% url "babybuddy:root-router" %}>
                <img src="{% static "babybuddy/logo/icon-brand.png" %}"
                     width="40"
                     height="40"
                     class="d-inline-block"
                     alt=""
                     style="margin-top: -2px;">
                <span class="d-none d-lg-inline-block ms-2">
                    <span class="text-primary">Baby</span> Buddy
                </span>
            </a>
            <div class="d-lg-none d-md-none d-flex me-auto p-0 ms-2">
                <div>
                <a class="text-body-secondary"
                   href="{% url 'dashboard:dashboard' %}"
                   aria-expanded="false"><i class="icon-2x icon-dashboard" aria-hidden="true"></i>
            </a>
            &nbsp;
        </div>
        <div>
        <a class="text-body-secondary"
           href="{% url 'core:timeline' %}"
           aria-expanded="false"><i class="icon-2x icon-timeline" aria-hidden="true"></i>
    </a>
    &nbsp;
</div>
</div>
<div class="d-lg-none d-md-none d-flex ms-auto p-0 me-2">
    {% quick_timer_nav %}
    <div class="dropdown show">
    <a class="text-success"
       href="#"
       role="button"
       id="nav-quick-add-link"
       data-bs-toggle="dropdown"
       aria-haspopup="true"
       aria-expanded="false"><i class="icon-2x icon-add" aria-hidden="true"></i>
</a>
<div class="dropdown-menu dropdown-menu-end bg-dark shadow"
     aria-labelledby="nav-quick-add-link"
     style="border: 1px solid rgba(255,255,255,0.1); min-width: 200px;">
    {% if perms.core.add_diaperchange %}
        <a class="dropdown-item py-2 ps-3 pe-2" href="{% url 'core:diaperchange-add' %}">
            <i class="icon-diaperchange" aria-hidden="true"></i>
            {% trans "Diaper Change" %}
        </a>
    {% endif %}
    {% if perms.core.add_medicationdose %}
        <a class="dropdown-item py-2 ps-3 pe-2" href="{% url 'core:medicationdose-add' %}">
            <i class="icon-medication" aria-hidden="true"></i>
            {% trans "Medication Dose" %}
        </a>
    {% endif %}
    {% if perms.core.add_feeding %}
        <a class="dropdown-item py-2 ps-3 pe-2" href="{% url 'core:feeding-add' %}">
            <i class="icon-feeding" aria-hidden="true"></i>
            {% trans "Feeding" %}
        </a>
    {% endif %}
    {% if perms.core.add_pumping %}
        {% load misc %}
        {% get_children_for_pumping as show_pumping %}
        {% if show_pumping %}
            <a class="dropdown-item py-2 ps-3 pe-2" href="{% url 'core:pumping-add' %}">
                <i class="icon-pumping" aria-hidden="true"></i>
                {% trans "Pumping" %}
            </a>
        {% endif %}
    {% endif %}
    {% if perms.core.add_note %}
        <a class="dropdown-item py-2 ps-3 pe-2" href="{% url 'core:note-add' %}">
            <i class="icon-note" aria-hidden="true"></i>
            {% trans "Note" %}
        </a>
    {% endif %}
    {% if perms.core.add_sleep %}
        <a class="dropdown-item py-2 ps-3 pe-2" href="{% url 'core:sleep-add' %}">
            <i class="icon-sleep" aria-hidden="true"></i>
            {% trans "Sleep" %}
        </a>
    {% endif %}
    {% if  perms.core.add_tummytime %}
        <a class="dropdown-item py-2 ps-3 pe-2" href="{% url 'core:tummytime-add' %}">
            <i class="icon-tummytime" aria-hidden="true"></i>
            {% trans "Tummy Time" %}
        </a>
    {% endif %}
</div>
</div>
</div>
<button class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbar-app"
        aria-controls="navbar-app"
        aria-expanded="false"
        aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbar-app">
    <ul class="navbar-nav me-auto">
        <li class="nav-item{% if request.path == '/' %} active{% endif %}">
            <a class="nav-link" href="{% url 'dashboard:dashboard' %}">
                <i class="icon-dashboard" aria-hidden="true"></i>
                {% trans "Dashboard" %}
            </a>
        </li>
        <li class="nav-item{% if request.path == '/timeline' %} active{% endif %}">
            <a class="nav-link" href="{% url 'core:timeline' %}">
                <i class="icon-timeline" aria-hidden="true"></i>
                {% trans "Timeline" %}
            </a>
        </li>
        <li class="nav-item dropdown">
        <a id="nav-notes-menu-link"
           class="nav-link dropdown-toggle"
           href="#"
           data-bs-toggle="dropdown"
           aria-haspopup="true"
           aria-expanded="false"><i class="icon-note" aria-hidden="true"></i>
        {% trans "Notes" %}
    </a>
    <div class="dropdown-menu" aria-labelledby="nav-notes-menu-link">
{% if perms.core.view_note %}
    <a class="dropdown-item{% if request.path == '/notes/' %} active{% endif %}"
       href="{% url 'core:note-list' %}">
        <i class="icon-note" aria-hidden="true"></i>
        {% trans "Notes" %}
    </a>
{% endif %}
{% if perms.core.add_note %}
<a class="dropdown-item ps-5{% if request.path == '/notes/add/' %} active{% endif %}"
   href="{% url 'core:note-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Note" %}
</a>
{% endif %}
</div>
</li>
<li class="nav-item dropdown">
<a id="nav-measurements-menu-link"
   class="nav-link dropdown-toggle"
   href="#"
   data-bs-toggle="dropdown"
   aria-haspopup="true"
   aria-expanded="false"><i class="icon-measurements" aria-hidden="true"></i>
{% trans "Measurements" %}
</a>
<div class="dropdown-menu" aria-labelledby="nav-measurements-menu-link">
    {% if perms.core.view_bmi %}
        <a class="dropdown-item{% if request.path == '/bmi/' %} active{% endif %}"
           href="{% url 'core:bmi-list' %}">
            <i class="icon-bmi" aria-hidden="true"></i>
            {% trans "BMI" %}
        </a>
    {% endif %}
    {% if perms.core.add_bmi %}
    <a class="dropdown-item ps-5{% if request.path == '/bmi/add/' %} active{% endif %}"
       href="{% url 'core:bmi-add' %}"><i class="icon-add" aria-hidden="true"></i>
    {% trans "BMI entry" %}
</a>
{% endif %}
{% if perms.core.view_head_circumference %}
    <a class="dropdown-item{% if request.path == '/head-circumference/' %} active{% endif %}"
       href="{% url 'core:head-circumference-list' %}">
        <i class="icon-head-circumference" aria-hidden="true"></i>
        {% trans "Head Circumference" %}
    </a>
{% endif %}
{% if perms.core.add_head_circumference %}
<a class="dropdown-item ps-5{% if request.path == '/head-circumference/add/' %} active{% endif %}"
   href="{% url 'core:head-circumference-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Head Circumference entry" %}
</a>
{% endif %}
{% if perms.core.view_height %}
    <a class="dropdown-item{% if request.path == '/height/' %} active{% endif %}"
       href="{% url 'core:height-list' %}">
        <i class="icon-height" aria-hidden="true"></i>
        {% trans "Height" %}
    </a>
{% endif %}
{% if perms.core.add_height %}
<a class="dropdown-item ps-5{% if request.path == '/height/add/' %} active{% endif %}"
   href="{% url 'core:height-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Height entry" %}
</a>
{% endif %}
{% if perms.core.view_temperature %}
    <a class="dropdown-item{% if request.path == '/temperature/' %} active{% endif %}"
       href="{% url 'core:temperature-list' %}">
        <i class="icon-temperature" aria-hidden="true"></i>
        {% trans "Temperature" %}
    </a>
{% endif %}
{% if perms.core.add_temperature %}
<a class="dropdown-item ps-5{% if request.path == '/temperature/add/' %} active{% endif %}"
   href="{% url 'core:temperature-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Temperature reading" %}
</a>
{% endif %}
{% if perms.core.view_weight %}
    <a class="dropdown-item{% if request.path == '/weight/' %} active{% endif %}"
       href="{% url 'core:weight-list' %}">
        <i class="icon-weight" aria-hidden="true"></i>
        {% trans "Weight" %}
    </a>
{% endif %}
{% if perms.core.add_weight %}
<a class="dropdown-item ps-5{% if request.path == '/weight/add/' %} active{% endif %}"
   href="{% url 'core:weight-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Weight entry" %}
</a>
{% endif %}
</div>
</li>
<li class="nav-item dropdown">
<a id="nav-activity-menu-link"
   class="nav-link dropdown-toggle"
   href="#"
   data-bs-toggle="dropdown"
   aria-haspopup="true"
   aria-expanded="false"><i class="icon-activities" aria-hidden="true"></i>
{% trans "Activities" %}
</a>
<div class="dropdown-menu" aria-labelledby="nav-activity-menu-link">
    {% if perms.core.view_diaperchange %}
    <a class="dropdown-item{% if request.path == '/changes/' %} active{% endif %}"
       href="{% url 'core:diaperchange-list' %}"><i class="icon-diaperchange" aria-hidden="true"></i>
    {% trans "Changes" %}
</a>
{% endif %}
{% if perms.core.add_diaperchange %}
<a class="dropdown-item ps-5{% if request.path == '/changes/add/' %} active{% endif %}"
   href="{% url 'core:diaperchange-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Change" %}
</a>
{% endif %}
{% if perms.core.view_feeding %}
<a class="dropdown-item{% if request.path == '/feedings/' %} active{% endif %}"
   href="{% url 'core:feeding-list' %}"><i class="icon-feeding" aria-hidden="true"></i>
{% trans "Feedings" %}
</a>
{% endif %}
{% if perms.core.view_medication %}
<a class="dropdown-item{% if request.path == '/medications/' %} active{% endif %}"
   href="{% url 'core:medication-list' %}"><i class="icon-medication" aria-hidden="true"></i>
{% trans "Medications" %}
</a>
{% endif %}
{% if perms.core.add_medication %}
<a class="dropdown-item ps-5{% if request.path == '/medications/add/' %} active{% endif %}"
   href="{% url 'core:medication-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Add Medication" %}
</a>
{% endif %}
{% if perms.core.view_medicationdose %}
<a class="dropdown-item{% if request.path == '/medication-doses/' %} active{% endif %}"
   href="{% url 'core:medicationdose-list' %}"><i class="icon-medication" aria-hidden="true"></i>
{% trans "Medication Doses" %}
</a>
{% endif %}
{% if perms.core.add_medicationdose %}
<a class="dropdown-item ps-5{% if request.path == '/medication-doses/add/' %} active{% endif %}"
   href="{% url 'core:medicationdose-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Medication Dose" %}
</a>
{% endif %}
{% if perms.core.add_feeding %}
<a class="dropdown-item ps-5{% if request.path == '/feedings/add/' %} active{% endif %}"
   href="{% url 'core:feeding-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Feeding" %}
</a>
{% endif %}
{% if perms.core.view_pumping %}
    <a class="dropdown-item{% if request.path == '/pumping/' %} active{% endif %}"
       href="{% url 'core:pumping-list' %}">
        <i class="icon-pumping" aria-hidden="true"></i>
        {% trans "Pumping" %}
    </a>
{% endif %}
{% if perms.core.add_pumping %}
<a class="dropdown-item ps-5{% if request.path == '/pumping/add/' %} active{% endif %}"
   href="{% url 'core:pumping-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Pumping entry" %}
</a>
{% endif %}
{% if perms.core.view_sleep %}
<a class="dropdown-item{% if request.path == '/sleep/' %} active{% endif %}"
   href="{% url 'core:sleep-list' %}"><i class="icon-sleep" aria-hidden="true"></i>
{% trans "Sleep" %}
</a>
{% endif %}
{% if perms.core.add_sleep %}
<a class="dropdown-item ps-5{% if request.path == '/sleep/add/' %} active{% endif %}"
   href="{% url 'core:sleep-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Sleep entry" %}
</a>
{% endif %}
{% if perms.core.view_tummytime %}
<a class="dropdown-item{% if request.path == '/tummy-time/' %} active{% endif %}"
   href="{% url 'core:tummytime-list' %}"><i class="icon-tummytime" aria-hidden="true"></i>
{% trans "Tummy Time" %}
</a>
{% endif %}
{% if perms.core.add_tummytime %}
<a class="dropdown-item ps-5{% if request.path == '/tummy-time/add/' %} active{% endif %}"
   href="{% url 'core:tummytime-add' %}"><i class="icon-add" aria-hidden="true"></i>
{% trans "Tummy Time entry" %}
</a>
{% endif %}
</div>
</li>
{% if perms.core.view_timer %}
    {% timer_nav %}
{% endif %}
</ul>
{% if request.user %}
    <ul class="navbar-nav ms-auto">
        <li class="nav-item dropdown">
            <a id="nav-user-menu-link"
               class="nav-link dropdown-toggle"
               href="#"
               data-bs-toggle="dropdown"
               aria-haspopup="true"
               aria-expanded="false">
                <i class="icon-user" aria-hidden="true"></i>
                {% if LANGUAGE_CODE == 'he' %}
                    ניהול
                {% else %}
                    {% trans "Settings" %}
                {% endif %}
            </a>
            <div class="dropdown-menu dropdown-menu-end"
                 aria-labelledby="nav-user-menu-link">
                <h6 class="dropdown-header">{% trans "Settings" %}</h6>
                {% if request.user.is_staff %}
                    <a href="{% url 'core:child-add' %}" class="dropdown-item">
                        {% trans "Add Child" %}
                    </a>
                    <a href="{% url 'core:child-list' %}" class="dropdown-item">
                        {% trans "Children" %}
                    </a>
                    <div class="dropdown-divider"></div>
                {% endif %}
                <a href="{% url 'babybuddy:user-settings' %}" class="dropdown-item">{% trans "User Settings" %}</a>
                <a href="{% url 'babybuddy:user-password' %}" class="dropdown-item">{% trans "Change Password" %}</a>
                <a href="{% url 'babybuddy:user-add-device' %}" class="dropdown-item">{% trans "Add a device" %}</a>
                {% if request.user.is_staff %}
                    <div class="dropdown-divider"></div>
                    <a href="{% url 'babybuddy:site_settings' %}" class="dropdown-item">{% trans "Site Settings" %}</a>
                    <a href="{% url 'core:tag-list' %}" class="dropdown-item">{% trans "Tags" %}</a>
                    <a href="{% url 'babybuddy:user-list' %}" class="dropdown-item">{% trans "Users" %}</a>
                    <a href="{% url 'admin:index' %}" class="dropdown-item">{% trans "Database Admin" %}</a>
                {% endif %}
                <div class="dropdown-divider"></div>
                <a href="{% url 'api:api-root' %}" class="dropdown-item">{% trans "API Browser" %}</a>
                <div class="dropdown-divider"></div>
                <form action="{% url 'babybuddy:logout' %}" role="form" method="post">
                    {% csrf_token %}
                    <button class="dropdown-item">{% trans "Logout" %}</button>
                </form>
            </div>
        </li>
    </ul>
{% endif %}
</div>
</div>
</nav>

<style>
/* Mobile quick-add menu styling */
#nav-quick-add-link + .dropdown-menu.bg-dark .dropdown-item {
    color: rgba(255, 255, 255, 0.85);
    transition: background-color 0.15s ease-in-out, color 0.15s ease-in-out;
}

#nav-quick-add-link + .dropdown-menu.bg-dark .dropdown-item:hover,
#nav-quick-add-link + .dropdown-menu.bg-dark .dropdown-item:focus {
    background-color: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 1);
}

#nav-quick-add-link + .dropdown-menu.bg-dark .dropdown-item i {
    opacity: 0.7;
    margin-right: 0.5rem;
}

#nav-quick-add-link + .dropdown-menu.bg-dark .dropdown-item:hover i {
    opacity: 1;
}

/* RTL dropdown positioning and z-index fixes */
[dir="rtl"] .dropdown-menu {
    right: 0 !important;
    left: auto !important;
}

[dir="rtl"] .dropdown-menu-end {
    right: 0 !important;
    left: auto !important;
}

.dropdown-menu {
    z-index: 1060 !important;
}

/* Fix quick-add menu in RTL */
[dir="rtl"] #nav-quick-add-link + .dropdown-menu.bg-dark {
    right: 0 !important;
    left: auto !important;
}
</style>
{% endblock %}
